<!-- /shop.html (HIGH-CONVERSION + your PayPal hosted buttons + consent-gated GA + cookie banner)
     Hosted Buttons + dropdown pricing is handled INSIDE PayPal (Black/Silver).
     This page:
       - Lets customer pick package (P1 / P2 / Ultimate)
       - Renders the correct hosted button into ONE container (keeps your main.js tracking hook)
       - Updates the displayed ‚Äúfrom‚Äù price based on package (Black base price)
       - Adds product/package IDs as data attributes

     IMPORTANT:
     - Keep PayPal SDK ONLY ONCE
     - Your /js/main.js begin_checkout listener is currently hard-coded to #paypal-container-KZTTHJVUHAFZC.
       This page keeps that ID so tracking still triggers.
-->
<!doctype html>
<html lang="en-GB">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <title>Shop ‚Äî PS2 FAT Console Packages | RetroReplay UK</title>
  <meta name="description" content="Choose a tested PS2 FAT console package (Player 1, Player 2, or Ultimate Modded Edition). Built to order, documented, supported. PayPal checkout." />
  <meta name="theme-color" content="#ffffff" />

  <link rel="icon" href="assets/favicon.svg" type="image/svg+xml" />
  <link rel="preload" as="image" href="assets/logo.png" />
  <link rel="stylesheet" href="style.css" />

  <!-- Site scripts -->
  <script defer src="js/analytics.js"></script>
  <script defer src="js/main.js"></script>

  <!-- PayPal SDK (ONCE) -->
  <script defer
    src="https://www.paypal.com/sdk/js?client-id=BAApYaG5zDntUHsd2tRXv1ylGkYhREqRR-t7PWcH3-Sh7ElgWliEyCEnhAeQjoawIGidc1LY7PQRK9A0Sg&components=hosted-buttons&disable-funding=venmo&currency=GBP">
  </script>

  <style>
    body.page-light{ background:#ffffff !important; color:#0b1020 !important; }
    body.page-light a{color:inherit}
    body.page-light .muted{color:rgba(11,16,32,.70) !important}

    body.page-light .header{
      position:sticky; top:0; z-index:50;
      background:rgba(255,255,255,.86) !important;
      backdrop-filter: blur(12px);
      border-bottom:1px solid rgba(11,16,32,.10);
    }

    .hero{
      padding: 54px 0 22px;
      background:
        radial-gradient(900px 520px at 12% -10%, rgba(135,234,255,.55), transparent 55%),
        radial-gradient(700px 420px at 92% 10%, rgba(25,207,255,.28), transparent 55%),
        linear-gradient(180deg, #ffffff, #f7fbff);
      border-bottom:1px solid rgba(11,16,32,.08);
      position:relative;
      overflow:hidden;
    }

    .hero__inner{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap: 18px;
      align-items:start;
      position:relative;
      z-index:1;
    }

    .kicker{ color: rgba(0,140,170,.95) !important; }
    .kicker::before{ box-shadow: 0 0 20px rgba(25,207,255,.25); }

    body.page-light .card{
      background: rgba(255,255,255,.94) !important;
      border: 1px solid rgba(11,16,32,.12) !important;
      box-shadow: 0 18px 45px rgba(0,0,0,.08) !important;
    }
    body.page-light .card--glow{
      border-color: rgba(25,207,255,.35) !important;
      box-shadow: 0 0 0 1px rgba(25,207,255,.12) inset, 0 18px 45px rgba(0,0,0,.08) !important;
    }
    body.page-light .divider{border-color: rgba(11,16,32,.10) !important}

    body.page-light .button{
      border:1px solid rgba(11,16,32,.14);
      background: rgba(255,255,255,.92);
      color:#0b1020;
      box-shadow: 0 10px 25px rgba(0,0,0,.06);
    }
    body.page-light .button:hover{border-color: rgba(25,207,255,.45)}
    body.page-light .button.button--ghost{
      background: rgba(135,234,255,.18);
      border-color: rgba(25,207,255,.35);
    }

    .trust{ padding-left:0; list-style:none; display:flex; flex-wrap:wrap; gap:10px; margin:14px 0 0; }
    .trust__item{
      border:1px solid rgba(11,16,32,.10);
      background: rgba(255,255,255,.80);
      color: rgba(11,16,32,.85);
      border-radius: 999px;
      padding: 8px 12px;
      font-size: .95rem;
    }

    .band{
      border:1px solid rgba(11,16,32,.10);
      background: rgba(255,255,255,.75);
      border-radius: 14px;
      padding: 14px;
      margin-top: 14px;
    }

    .pkg-grid{ display:grid; grid-template-columns: repeat(3, 1fr); gap:14px; margin-top:14px; }
    .pkg{
      cursor:pointer;
      transition: transform .12s ease;
      text-align:left;
    }
    .pkg:hover{ transform: translateY(-2px); }
    .pkg[aria-pressed="true"]{
      outline: 3px solid rgba(25,207,255,.35);
      outline-offset: 2px;
      box-shadow: 0 0 0 1px rgba(25,207,255,.12) inset, 0 18px 45px rgba(0,0,0,.08) !important;
    }

    .tag{
      display:inline-flex;
      border:1px solid rgba(11,16,32,.12);
      background: rgba(135,234,255,.18);
      color: rgba(11,16,32,.86);
      border-radius: 999px;
      padding: 6px 10px;
      font-size:.9rem;
      font-weight:650;
    }

    .pkg__head{ display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap; }
    .list{ margin: 10px 0 0; padding-left: 18px; }
    .list li{ margin: 8px 0; color: rgba(11,16,32,.86); }

    .price-row{ display:flex; gap:12px; align-items:baseline; justify-content:space-between; flex-wrap:wrap; }
    .price{ font-size: 1.8rem; font-weight: 800; letter-spacing: -.02em; }
    .subprice{ font-size:.95rem; color: rgba(11,16,32,.70); }

    .sticky-buy{
      position: fixed; left: 0; right: 0; bottom: 0;
      z-index: 60;
      background: rgba(255,255,255,.92);
      backdrop-filter: blur(12px);
      border-top: 1px solid rgba(11,16,32,.12);
      padding: 10px 12px;
      display: none;
    }
    .sticky-buy__inner{
      max-width: 1100px; margin: 0 auto;
      display:flex; gap:10px; align-items:center; justify-content: space-between;
    }
    .sticky-buy__text{ font-size: .95rem; color: rgba(11,16,32,.85); }
    .sticky-buy__actions{ display:flex; gap:10px; }

    .float-layer{ position:absolute; inset:0; pointer-events:none; z-index:0; }
    .float-item{
      position:absolute; opacity:.16;
      filter: drop-shadow(0 12px 26px rgba(0,0,0,.10));
      transform: translate3d(0,0,0);
      animation: floaty 10s ease-in-out infinite;
      will-change: transform;
    }
    .float-item svg{ width: clamp(44px, 7vw, 92px); height: auto; display:block; }
    .float-item .stroke{stroke: rgba(11,16,32,.65)}
    .float-item .fill{fill: rgba(25,207,255,.22)}
    @keyframes floaty{
      0%,100%{ transform: translate3d(0, 0, 0) rotate(0deg); }
      50%{ transform: translate3d(0, -18px, 0) rotate(2deg); }
    }

    @media (max-width: 980px){
      .hero__inner{ grid-template-columns: 1fr; }
      .pkg-grid{ grid-template-columns: 1fr; }
    }
    @media (max-width: 600px){
      .hero{ padding: 44px 0 18px; }
      .sticky-buy{ display:block; }
      body{ padding-bottom: 76px; }
      .float-item{ opacity:.12; }
    }
  </style>
</head>

<body class="page-light">
  <a class="skip" href="#main">Skip to content</a>

  <header class="header">
    <div class="container header__inner">
      <a class="brand" href="index.html" aria-label="RetroReplay UK Home">
        <img class="brand__logo" src="assets/logo.png" alt="RetroReplay UK" width="220" height="220" />
      </a>

      <nav class="nav" aria-label="Primary">
        <a class="nav__link" href="index.html">Home</a>
        <a class="nav__link is-active" href="shop.html" aria-current="page">Shop</a>
        <a class="nav__link" href="support.html">Support</a>
        <a class="nav__link" href="contact.html">Contact</a>
      </nav>

      <a class="button button--ghost header__cta" href="#buy" data-cta="header_buy">Checkout</a>
    </div>
  </header>

  <main id="main">
    <section class="hero" aria-label="Shop hero">
      <div class="float-layer" id="float-layer" aria-hidden="true"></div>

      <div class="container hero__inner">
        <!-- LEFT -->
        <div>
          <p class="kicker">üéÆ PlayStation 2 FAT Console ‚Äì Package Options</p>
          <h1 class="h1">Tested ‚Ä¢ Prepared ‚Ä¢ Built to Order | RetroReplay UK</h1>

          <p class="lead">
            This PlayStation 2 FAT console is fully tested and carefully prepared, not job-lot stock or an untested resale.
            Each console is individually assessed to ensure correct operation before dispatch.
          </p>

          <div class="band" role="note" aria-label="Standard preparation">
            <strong>üîß Standard Preparation (All Packages)</strong>
            <ul class="list" style="margin-top:10px;">
              <li>‚úî Full functional testing</li>
              <li>‚úî Optical drive tested</li>
              <li>‚úî Fault diagnosis and repair where required</li>
              <li>‚úî Extended play testing</li>
              <li>‚úî Prepared memory card included</li>
              <li>‚úî Documentation supplied</li>
            </ul>
          </div>

          <ul class="trust" aria-label="Trust badges">
            <li class="trust__item">No job-lot consoles</li>
            <li class="trust__item">Clear package options</li>
            <li class="trust__item">After-sales support included</li>
          </ul>
        </div>

        <!-- RIGHT: BUY BOX -->
        <div id="buy">
          <div class="card card--glow">
            <div class="price-row">
              <div>
                <div class="price" id="price-text">From ¬£149.99</div>
                <div class="subprice" id="subprice-text">Select your package, then choose Black/Silver in PayPal dropdown.</div>
              </div>
              <a class="button button--ghost" href="support.html" data-cta="buybox_support">Warranty &amp; Support</a>
            </div>

            <div class="divider" style="margin:14px 0;"></div>

            <h2 class="h2" style="margin-bottom:6px;">Select your package</h2>

            <div class="pkg-grid" role="group" aria-label="Package selection">
              <button class="card pkg" type="button" aria-pressed="false"
                      data-package="p1"
                      data-product-id="ps2-fat-p1"
                      data-title="üü¶ Player 1 Plug & Play"
                      data-items="PlayStation 2 FAT console|1√ó wired controller (third-party)|1√ó prepared memory card|Composite AV cable|Warranty & authenticity documentation"
                      data-ideal="Ideal for: solo players, gifts, first-time PS2 buyers."
                      data-hosted-id="JMNWZWNM943Z8"
                      data-from-price="119.99"
                      data-cta="select_p1">
                <div class="pkg__head">
                  <h3 class="h3" style="margin:0;">üü¶ Player 1 Plug &amp; Play</h3>
                  <span class="tag">From ¬£119.99</span>
                </div>
              </button>

              <button class="card pkg" type="button" aria-pressed="false"
                      data-package="p2"
                      data-product-id="ps2-fat-p2"
                      data-title="üü® Player 2 Plug & Play"
                      data-items="Everything in Player 1|2√ó wired controllers (third-party)|Extended system testing|Priority preparation"
                      data-ideal="Ideal for: families, shared gaming, better-value buyers."
                      data-hosted-id="K8455AQ6AKK3L"
                      data-from-price="149.99"
                      data-cta="select_p2">
                <div class="pkg__head">
                  <h3 class="h3" style="margin:0;">üü® Player 2 Plug &amp; Play</h3>
                  <span class="tag">‚≠ê Best Value</span>
                </div>
              </button>

              <button class="card pkg" type="button" aria-pressed="false"
                      data-package="ultimate"
                      data-product-id="ps2-fat-ultimate"
                      data-title="üü• The Ultimate Modded Edition ‚Äî Serious-Player Build"
                      data-items="Everything in Player 2|Network adapter installed|Advanced system configuration (FMCB environment)|Disc-free ready hardware setup|Internal SATA hard drive option available|Optimised boot flow and system layout|Extended stress testing|Configuration documentation"
                      data-ideal="Ideal for: enthusiasts, long-term owners, collectors."
                      data-hosted-id="RCX5N5QAH75PJ"
                      data-from-price="179.99"
                      data-cta="select_ultimate">
                <div class="pkg__head">
                  <h3 class="h3" style="margin:0;">üü• Ultimate Modded Edition</h3>
                  <span class="tag">From ¬£179.99</span>
                </div>
              </button>
            </div>

            <div class="band" id="selection-details" aria-live="polite" style="margin-top:14px;">
              <strong id="sel-title">Select a package above</strong>
              <ul class="list" id="sel-items" style="margin-top:10px;"></ul>
              <p class="muted" id="sel-ideal" style="margin-top:8px;"></p>
              <p class="muted" style="margin-top:8px;">
                <strong>Colour pricing:</strong> Choose <strong>Black</strong> or <strong>Silver</strong> inside the PayPal dropdown.
              </p>
            </div>

            <div class="divider" style="margin:14px 0;"></div>

            <h2 class="h2">Checkout</h2>
            <p class="muted" style="margin-top:6px;">
              Choose your colour in PayPal, then complete checkout. If you cancel, you‚Äôll return here.
            </p>

            <!-- KEEP THIS ID (your /js/main.js uses it for begin_checkout) -->
            <div id="paypal-container-KZTTHJVUHAFZC" style="margin-top:12px;"></div>

            <p class="fineprint" style="margin-top:10px;">
              By purchasing you agree to our <a href="terms.html">Terms</a> and <a href="privacy.html">Privacy</a>.
            </p>

            <div class="divider" style="margin:14px 0;"></div>

            <p class="muted">
              Want upgrades (wireless / HDMI / HDD sizes / refurbishment)? Message your choices immediately after purchase.
              <a href="#upgrades" data-cta="see_upgrades">See upgrades</a>.
            </p>
          </div>
        </div>
      </div>
    </section>

    <section class="section" id="upgrades" aria-label="Optional upgrades">
      <div class="container">
        <h2 class="h2">‚ûï Optional upgrades</h2>
        <p class="muted">Please choose and include in your message after purchase.</p>

        <div class="band">
          <strong>üéÆ Controllers &amp; Play</strong>
          <ul class="list">
            <li>Wireless controller upgrade</li>
            <li>Original Sony controller (subject to availability)</li>
            <li>4-Player option (additional controllers)</li>
          </ul>
        </div>

        <div class="band">
          <strong>üì∫ Video</strong>
          <ul class="list">
            <li>HD Component (YPbPr) cable</li>
            <li>HDMI upscaler</li>
          </ul>
        </div>

        <div class="band">
          <strong>üíæ Ultimate Build Only</strong>
          <ul class="list">
            <li>HDD size options: 320GB / 500GB / 1TB / 2TB</li>
          </ul>
        </div>

        <div class="band">
          <strong>üîß Services</strong>
          <ul class="list">
            <li>Full Restore (Clean) ‚Äì cosmetic only, no internal work</li>
            <li>Full Refurbishment ‚Äì internal &amp; external restoration</li>
            <li>Priority preparation slot</li>
          </ul>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="container footer__inner">
      <p class="fineprint">¬© <span data-year></span> RetroReplay UK</p>
      <div class="footer__links">
        <a href="support.html" data-cta="footer_support">Warranty &amp; Support</a>
        <a href="privacy.html" data-cta="footer_privacy">Privacy</a>
        <a href="cookies.html" data-cta="footer_cookies">Cookies</a>
        <a href="contact.html" data-cta="footer_contact">Contact</a>
      </div>
    </div>
  </footer>

  <!-- Cookie consent banner (required selectors for /js/main.js) -->
  <div class="cookie" role="dialog" aria-live="polite" aria-label="Cookie consent" hidden>
    <div class="cookie__inner">
      <p class="cookie__text">
        We use cookies for analytics to improve the site. You can accept or reject non-essential cookies.
      </p>
      <div class="cookie__actions">
        <button class="button button--ghost" type="button" data-cookie-reject>Reject</button>
        <button class="button" type="button" data-cookie-accept>Accept</button>
      </div>
    </div>
  </div>

  <!-- Sticky mobile buy bar -->
  <div class="sticky-buy" aria-label="Quick buy bar">
    <div class="sticky-buy__inner">
      <div class="sticky-buy__text"><strong>PS2 Packages</strong> ‚Äî choose & checkout</div>
      <div class="sticky-buy__actions">
        <a class="button button--ghost" href="#buy" data-cta="sticky_checkout">Checkout</a>
        <a class="button" href="contact.html" data-cta="sticky_question">Ask</a>
      </div>
    </div>
  </div>

  <!-- Package -> PayPal render (uses your 3 hostedButtonIds) -->
  <script>
    (function(){
      const target = "#paypal-container-KZTTHJVUHAFZC";

      function renderHostedButton(hostedButtonId){
        const el = document.querySelector(target);
        if (!el) return;
        el.innerHTML = "";
        if (!window.paypal || !paypal.HostedButtons) {
          el.innerHTML = "<p class='muted'>PayPal is loading‚Ä¶</p>";
          return;
        }
        paypal.HostedButtons({ hostedButtonId }).render(target);
      }

      function setPressed(btn){
        document.querySelectorAll(".pkg").forEach(b => b.setAttribute("aria-pressed","false"));
        btn.setAttribute("aria-pressed","true");
      }

      function setDetails(btn){
        const title = btn.getAttribute("data-title") || "Selected package";
        const items = (btn.getAttribute("data-items") || "").split("|").filter(Boolean);
        const ideal = btn.getAttribute("data-ideal") || "";

        document.getElementById("sel-title").textContent = title;
        document.getElementById("sel-items").innerHTML = items.map(t => `<li>${t}</li>`).join("");
        document.getElementById("sel-ideal").textContent = ideal;

        document.getElementById("selection-details").setAttribute("data-selected-product-id", btn.getAttribute("data-product-id") || "");
      }

      function setFromPrice(btn){
        const from = btn.getAttribute("data-from-price");
        if (!from) return;
        document.getElementById("price-text").textContent = `From ¬£${Number(from).toFixed(2)}`;
        document.getElementById("subprice-text").textContent = "Select your colour in the PayPal dropdown (Black/Silver).";
      }

      function select(btn){
        const hostedId = btn.getAttribute("data-hosted-id");
        const pkg = btn.getAttribute("data-package") || "";
        if (!hostedId) return;

        setPressed(btn);
        setDetails(btn);
        setFromPrice(btn);
        renderHostedButton(hostedId);

        const u = new URL(window.location.href);
        u.searchParams.set("package", pkg);
        window.history.replaceState({}, "", u.toString());
      }

      window.addEventListener("load", () => {
        document.querySelectorAll(".pkg").forEach(btn => btn.addEventListener("click", () => select(btn)));

        const u = new URL(window.location.href);
        const pkg = (u.searchParams.get("package") || "").toLowerCase();
        const btn = document.querySelector(`.pkg[data-package="${pkg}"]`) || document.querySelector('.pkg[data-package="p2"]');
        if (btn) select(btn);

        if (u.searchParams.get("success")==="1" || u.searchParams.get("cancel")==="1") {
          document.getElementById("buy")?.scrollIntoView({ behavior:"smooth", block:"start" });
        }
      });
    })();
  </script>

  <!-- Floating controllers -->
  <script>
    (function () {
      const layer = document.getElementById("float-layer");
      if (!layer) return;

      const isMobile = matchMedia("(max-width: 600px)").matches;
      const count = isMobile ? 5 : 9;

      const svgController = () => `
        <svg viewBox="0 0 128 72" xmlns="http://www.w3.org/2000/svg" role="presentation" aria-hidden="true">
          <path class="fill" d="M20 34c0-10 8-18 18-18h52c10 0 18 8 18 18v6c0 10-8 18-18 18h-7l-10-9H55l-10 9h-7c-10 0-18-8-18-18v-6Z" />
          <path class="stroke" d="M20 34c0-10 8-18 18-18h52c10 0 18 8 18 18v6c0 10-8 18-18 18h-7l-10-9H55l-10 9h-7c-10 0-18-8-18-18v-6Z" fill="none" stroke-width="2"/>
          <circle class="stroke" cx="88" cy="35" r="5" fill="none" stroke-width="2"/>
          <circle class="stroke" cx="102" cy="35" r="5" fill="none" stroke-width="2"/>
          <path class="stroke" d="M44 32h-10M39 27v10" fill="none" stroke-width="2" stroke-linecap="round"/>
        </svg>
      `;

      for (let i = 0; i < count; i++) {
        const d = document.createElement("div");
        d.className = "float-item";
        d.innerHTML = svgController();

        d.style.left = Math.floor(Math.random() * 92) + "%";
        d.style.top = Math.floor(Math.random() * 78) + "%";
        d.style.animationDuration = (8 + Math.random() * 6) + "s";
        d.style.animationDelay = (Math.random() * 2) + "s";
        d.style.transform = `rotate(${(Math.random() * 8 - 4).toFixed(1)}deg)`;
        layer.appendChild(d);
      }

      if (!isMobile) {
        window.addEventListener("mousemove", (e) => {
          const x = (e.clientX / window.innerWidth - 0.5) * 6;
          const y = (e.clientY / window.innerHeight - 0.5) * 6;
          layer.style.transform = `translate3d(${x}px, ${y}px, 0)`;
        }, { passive: true });
      }
    })();
  </script>
</body>
</html>
